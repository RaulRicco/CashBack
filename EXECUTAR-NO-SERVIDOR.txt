â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘              ðŸš€ COMANDOS PARA EXECUTAR NO SERVIDOR VPS                       â•‘
â•‘                                                                              â•‘
â•‘         Sistema de RecuperaÃ§Ã£o de Senha com CÃ³digo de 6 DÃ­gitos             â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“‹ PASSO 1: CONECTAR NO SERVIDOR VIA SSH
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ssh usuario@seu-servidor.com

(Substitua com suas credenciais reais)


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“‹ PASSO 2: EXECUTAR SCRIPT DE DEPLOY
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Copie e cole este comando COMPLETO no terminal:


cd /var/www/cashback && \
git fetch origin genspark_ai_developer && \
git reset --hard origin/genspark_ai_developer && \
bash DEPLOY-RECUPERACAO-SENHA.sh


â±ï¸  TEMPO ESTIMADO: 3-5 minutos

O script vai:
âœ… Fazer backup do build anterior
âœ… Baixar cÃ³digo atualizado do GitHub
âœ… Verificar variÃ¡veis de ambiente (.env)
âœ… Instalar dependÃªncias
âœ… Limpar cache
âœ… Fazer build novo
âœ… Recarregar Nginx
âœ… Reiniciar integration-proxy


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“‹ PASSO 3: CRIAR TABELA NO SUPABASE (âš ï¸ OBRIGATÃ“RIO)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Acesse: https://supabase.com
2. FaÃ§a login
3. Selecione seu projeto (cashback)
4. VÃ¡ em "SQL Editor" (no menu lateral)
5. Clique em "New Query"
6. Copie e cole o SQL abaixo:


-- ============================================
-- ðŸ”’ TABELA PARA RECUPERAÃ‡ÃƒO DE SENHA
-- ============================================

CREATE TABLE IF NOT EXISTS password_reset_tokens (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  email TEXT NOT NULL,
  token TEXT NOT NULL UNIQUE,
  user_type TEXT NOT NULL CHECK (user_type IN ('merchant', 'customer')),
  user_id UUID,
  expires_at TIMESTAMP NOT NULL,
  used BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX IF NOT EXISTS idx_password_reset_token ON password_reset_tokens(token);
CREATE INDEX IF NOT EXISTS idx_password_reset_email ON password_reset_tokens(email);
CREATE INDEX IF NOT EXISTS idx_password_reset_expires ON password_reset_tokens(expires_at);
CREATE INDEX IF NOT EXISTS idx_password_reset_used ON password_reset_tokens(used);

ALTER TABLE password_reset_tokens ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Permitir criar tokens de reset"
ON password_reset_tokens FOR INSERT
TO anon, authenticated
WITH CHECK (true);

CREATE POLICY "Permitir ler tokens vÃ¡lidos"
ON password_reset_tokens FOR SELECT
TO anon, authenticated
USING (used = false AND expires_at > NOW());

CREATE POLICY "Permitir marcar token como usado"
ON password_reset_tokens FOR UPDATE
TO anon, authenticated
USING (used = false AND expires_at > NOW())
WITH CHECK (used = true);

CREATE POLICY "Permitir deletar tokens expirados"
ON password_reset_tokens FOR DELETE
TO authenticated
USING (expires_at < NOW() OR used = true);


7. Clique em "RUN" (ou pressione Ctrl+Enter)
8. Aguarde mensagem de sucesso âœ…


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“‹ PASSO 4: TESTAR O SISTEMA
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£  Limpar Cache do Navegador:
   - Chrome: Ctrl+Shift+Del â†’ Limpar cache
   - Ou abra aba anÃ´nima: Ctrl+Shift+N

2ï¸âƒ£  Acessar PÃ¡gina de RecuperaÃ§Ã£o:
   - URL: https://seu-dominio.com/forgot-password

3ï¸âƒ£  Solicitar CÃ³digo:
   - Digite um email cadastrado
   - Selecione "Estabelecimento" ou "Cliente"
   - Clique em "Enviar CÃ³digo de VerificaÃ§Ã£o"
   - VocÃª serÃ¡ redirecionado automaticamente

4ï¸âƒ£  Verificar Email:
   - Abra seu email
   - âš ï¸ Verifique tambÃ©m SPAM/Lixo EletrÃ´nico
   - Procure email com assunto: "CÃ³digo de RecuperaÃ§Ã£o de Senha"
   - Copie o cÃ³digo de 6 dÃ­gitos

5ï¸âƒ£  Redefinir Senha:
   - Cole o cÃ³digo no campo
   - Digite nova senha (mÃ­nimo 6 caracteres)
   - Confirme a senha
   - Clique em "Alterar Senha"

6ï¸âƒ£  Fazer Login:
   - VocÃª serÃ¡ redirecionado para /login
   - Digite seu email
   - Digite a NOVA senha
   - Clique em "Entrar"
   - âœ… Sucesso!


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ› SOLUÃ‡ÃƒO DE PROBLEMAS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ Email nÃ£o chega:
   1. Verifique SPAM/Lixo EletrÃ´nico
   2. Aguarde atÃ© 5 minutos
   3. Verifique se o email estÃ¡ correto
   4. Abra console do navegador (F12) e veja os logs
   5. Acesse: https://resend.com/emails e veja se foi enviado

âŒ CÃ³digo invÃ¡lido:
   1. Verifique se digitou os 6 dÃ­gitos corretos
   2. CÃ³digo expira em 15 minutos - solicite novo se expirou
   3. CÃ³digo sÃ³ pode ser usado uma vez
   4. Verifique se selecionou o tipo correto (Estabelecimento/Cliente)

âŒ Tabela nÃ£o existe:
   1. Execute novamente o SQL no Supabase
   2. Verifique se nÃ£o houve erro ao executar
   3. Aguarde alguns segundos e tente novamente

âŒ Build falhou:
   1. Verifique se Node.js estÃ¡ instalado: node --version
   2. Verifique se npm estÃ¡ instalado: npm --version
   3. Execute novamente o script de deploy
   4. Veja logs em: /var/www/cashback/cashback-system/

âŒ Nginx nÃ£o reiniciou:
   1. Verifique status: sudo systemctl status nginx
   2. Teste config: sudo nginx -t
   3. Reinicie manualmente: sudo systemctl restart nginx


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“ ARQUIVOS IMPORTANTES NO SERVIDOR
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ðŸ“‚ Projeto:
   /var/www/cashback/

ðŸ“‚ AplicaÃ§Ã£o:
   /var/www/cashback/cashback-system/

ðŸ“„ Build:
   /var/www/cashback/cashback-system/dist/

ðŸ“„ SQL para Supabase:
   /var/www/cashback/CRIAR-TABELA-PASSWORD-RESET.sql

ðŸ“– DocumentaÃ§Ã£o:
   /var/www/cashback/CONFIGURAR-RECUPERACAO-SENHA.md

ðŸ”§ Logs do proxy:
   /var/www/cashback/integration-proxy.log

ðŸ“¦ Backups:
   /var/www/cashback/backup-dist-YYYYMMDD-HHMMSS/


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ” COMANDOS ÃšTEIS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# Ver status do Nginx
sudo systemctl status nginx

# Ver logs do Nginx
sudo tail -f /var/log/nginx/error.log

# Ver logs do integration-proxy
tail -f /var/www/cashback/integration-proxy.log

# Verificar processos Node
ps aux | grep node

# Reiniciar Nginx
sudo systemctl restart nginx

# Verificar se porta 3001 estÃ¡ em uso (proxy)
sudo netstat -tulpn | grep 3001


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… CHECKLIST FINAL
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Antes de testar:
â–¡ Script de deploy executado com sucesso
â–¡ Tabela password_reset_tokens criada no Supabase
â–¡ Cache do navegador limpo
â–¡ Email do Resend funcionando

Testado:
â–¡ PÃ¡gina /forgot-password carrega
â–¡ Consegue solicitar cÃ³digo
â–¡ Email chega com cÃ³digo de 6 dÃ­gitos
â–¡ PÃ¡gina /reset-password aceita o cÃ³digo
â–¡ Senha Ã© alterada com sucesso
â–¡ Login funciona com nova senha


â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸŽ‰ PRONTO!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Depois de executar esses passos, o sistema de recuperaÃ§Ã£o de senha estarÃ¡
100% funcional em produÃ§Ã£o!

Se tiver algum problema, verifique os logs ou me avise! ðŸš€


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                              â•‘
â•‘                     Pull Request: #2 no GitHub                               â•‘
â•‘              https://github.com/RaulRicco/CashBack/pull/2                    â•‘
â•‘                                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
