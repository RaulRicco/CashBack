â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘           ğŸ” RECUPERAÃ‡ÃƒO DE SENHA PARA CLIENTES - IMPLEMENTADO               â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… O QUE FOI FEITO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Sistema completo de recuperaÃ§Ã£o de senha para CLIENTES (nÃ£o estabelecimentos).

FUNCIONALIDADES:
  âœ… Solicitar cÃ³digo de recuperaÃ§Ã£o via telefone
  âœ… Validar cÃ³digo (6 dÃ­gitos, expira em 30 min)
  âœ… Redefinir senha
  âœ… Link "Esqueceu sua senha?" na tela de login

IDENTIDADE VISUAL:
  âœ… Mesma identidade dos estabelecimentos
  âœ… Gradiente de fundo primary
  âœ… Card branco centralizado
  âœ… Logo do sistema
  âœ… AnimaÃ§Ãµes e feedbacks visuais


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‚ ARQUIVOS CRIADOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CÃ“DIGO:
  âœ… src/pages/CustomerForgotPassword.jsx      (7.6 KB)
  âœ… src/pages/CustomerResetPassword.jsx       (11.3 KB)
  âœ… CREATE-CUSTOMER-PASSWORD-RECOVERY.sql     (3.9 KB)

DOCUMENTAÃ‡ÃƒO:
  âœ… RECUPERACAO-SENHA-CLIENTES.md             (12 KB)
  âœ… RESUMO-RECUPERACAO-SENHA.txt              (este arquivo)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ ARQUIVOS MODIFICADOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âœ… src/App.jsx                               (rotas adicionadas)
  âœ… src/pages/CustomerDashboard.jsx           (link "Esqueceu senha")


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”„ FLUXO DE USO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Cliente acessa: /customer/dashboard/11999999999

2. NÃ£o lembra senha â†’ Clica em "Esqueceu sua senha?"

3. Redireciona para: /customer/forgot-password

4. Digita telefone: (11) 99999-9999

5. Clica em "Gerar CÃ³digo de RecuperaÃ§Ã£o"

6. Sistema:
   â†’ Busca cliente pelo telefone
   â†’ Gera cÃ³digo: 789456
   â†’ Salva no banco (expira em 30 min)
   â†’ Mostra toast com cÃ³digo
   â†’ Redireciona para /customer/reset-password?phone=...&token=...

7. PÃ¡gina valida token:
   â†’ Se vÃ¡lido: mostra formulÃ¡rio de nova senha
   â†’ Se invÃ¡lido/expirado: mostra erro + botÃ£o "Solicitar Novo"

8. Cliente define nova senha

9. Sistema:
   â†’ Atualiza senha
   â†’ Marca token como usado
   â†’ Redireciona para dashboard

10. Cliente faz login com NOVA senha âœ…


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ—„ï¸ BANCO DE DADOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TABELA: customer_password_recovery_tokens

ESTRUTURA:
  - id (UUID)
  - customer_id (UUID) â†’ FK para customers
  - token (VARCHAR 6)
  - expires_at (TIMESTAMPTZ)
  - used (BOOLEAN)
  - created_at (TIMESTAMPTZ)
  - used_at (TIMESTAMPTZ)

POLÃTICAS RLS:
  âœ… InserÃ§Ã£o pÃºblica (gerar tokens)
  âœ… Leitura pÃºblica (validar tokens)
  âœ… AtualizaÃ§Ã£o pÃºblica (marcar como usado)

FUNÃ‡ÃƒO DE LIMPEZA:
  delete_expired_customer_tokens()
  â†’ Deleta tokens expirados hÃ¡ mais de 24 horas


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ DEPLOY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASSO 1 - Executar SQL no Supabase:
  1. Acesse: https://supabase.com
  2. Selecione o projeto
  3. VÃ¡ em SQL Editor
  4. Cole o conteÃºdo de CREATE-CUSTOMER-PASSWORD-RECOVERY.sql
  5. Execute (Run)

PASSO 2 - Deploy do Frontend:
  ssh root@31.97.167.88
  cd /var/www/cashback/cashback-system
  git pull origin main
  npm install --legacy-peer-deps
  npm run build
  sudo systemctl reload nginx

PASSO 3 - Testar:
  https://localcashback.com.br/customer/dashboard/11999999999
  â†’ Clicar em "Esqueceu sua senha?"
  â†’ Seguir fluxo de recuperaÃ§Ã£o


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ª TESTE RÃPIDO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Criar cliente de teste (SQL):
   INSERT INTO customers (phone, name, password_hash, cashback_balance)
   VALUES ('11999999999', 'Cliente Teste', 'MTIzNDU2', 0.00);
   -- Senha: 123456

2. Acesse:
   https://localcashback.com.br/customer/dashboard/11999999999

3. Clique em "Esqueceu sua senha?"

4. Digite: (11) 99999-9999

5. Copie o cÃ³digo que aparece no toast

6. Defina nova senha

7. FaÃ§a login com a NOVA senha


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš ï¸ IMPORTANTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PRODUÃ‡ÃƒO:
  âš ï¸ CÃ³digo mostrado em TOAST (desenvolvimento)
  âœ… Em produÃ§Ã£o: integrar SMS/WhatsApp
  
SEGURANÃ‡A:
  âš ï¸ Usando btoa() para hash (desenvolvimento)
  âœ… Em produÃ§Ã£o: usar bcrypt/Argon2
  
RATE LIMITING:
  âš ï¸ Sem limite de tentativas (desenvolvimento)
  âœ… Em produÃ§Ã£o: limitar tentativas/hora


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š COMPARAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    ESTABELECIMENTO       |       CLIENTE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Identificador:      Email                 |       Telefone
Tabela Tokens:      password_recovery_    |       customer_password_
                    tokens                |       recovery_tokens
PÃ¡gina Forgot:      /forgot-password      |       /customer/forgot-password
PÃ¡gina Reset:       /reset-password       |       /customer/reset-password
Envio:              Email (futuro)        |       SMS/WhatsApp (futuro)
UI:                 âœ… Visual padrÃ£o      |       âœ… Mesmo visual


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DESENVOLVIMENTO:
  [âœ…] CustomerForgotPassword.jsx criado
  [âœ…] CustomerResetPassword.jsx criado
  [âœ…] Rotas adicionadas no App.jsx
  [âœ…] Link na tela de login
  [âœ…] SQL da tabela criado
  [âœ…] Build compilado
  [âœ…] DocumentaÃ§Ã£o criada

PRODUÃ‡ÃƒO (prÃ³ximos passos):
  [ ] Executar SQL no Supabase
  [ ] Integrar envio de SMS/WhatsApp
  [ ] Implementar bcrypt
  [ ] Adicionar rate limiting
  [ ] Configurar cron job de limpeza


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ RESUMO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Sistema completo implementado
âœ… Mesma identidade visual
âœ… ValidaÃ§Ã£o de token (expiraÃ§Ã£o + uso Ãºnico)
âœ… Link acessÃ­vel na tela de login
âœ… Build pronto para deploy
âœ… SQL pronto para Supabase


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                               â•‘
â•‘                    âœ… IMPLEMENTAÃ‡ÃƒO CONCLUÃDA! âœ…                             â•‘
â•‘                                                                               â•‘
â•‘                  Aguardando apenas execuÃ§Ã£o do SQL                            â•‘
â•‘                       no Supabase para ativar                                 â•‘
â•‘                                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
